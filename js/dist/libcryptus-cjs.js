var Cryptus=function(){"use strict";function e(e,n,t,r,o,i,u){try{var a=e[i](u),c=a.value}catch(e){return void t(e)}a.done?n(c):Promise.resolve(c).then(r,o)}function n(n){return function(){var t=this,r=arguments;return new Promise(function(o,i){var u=n.apply(t,r);function a(n){e(u,o,i,a,c,"next",n)}function c(n){e(u,o,i,a,c,"throw",n)}a(void 0)})}}function t(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function r(e,n,t){return n&&function(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e,n,t){return(n=s(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach(function(n){o(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function a(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function i(t,r,o,i){var a=r&&r.prototype instanceof s?r:s,f=Object.create(a.prototype);return c(f,"_invoke",function(t,r,o){var i,a,c,s=0,f=o||[],p=!1,l={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(n,t){return i=n,a=0,c=e,l.n=t,u}};function v(t,r){for(a=t,c=r,n=0;!p&&s&&!o&&n<f.length;n++){var o,i=f[n],v=l.p,y=i[2];t>3?(o=y===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=v&&((o=t<2&&v<i[1])?(a=0,l.v=r,l.n=i[1]):v<y&&(o=t<3||i[0]>r||r>y)&&(i[4]=t,i[5]=r,l.n=y,a=0))}if(o||t>1)return u;throw p=!0,r}return function(o,f,y){if(s>1)throw TypeError("Generator is already running");for(p&&1===f&&v(f,y),a=f,c=y;(n=a<2?e:c)||!p;){i||(a?a<3?(a>1&&(l.n=-1),v(a,c)):l.n=c:l.v=c);try{if(s=2,i){if(a||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,a<2&&(a=0)}else 1===a&&(n=i.return)&&n.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=e}else if((n=(p=l.n<0)?c:t.call(r,l))!==u)break}catch(n){i=e,a=1,c=n}finally{s=1}}return{value:n,done:p}}}(t,o,i),!0),f}var u={};function s(){}function f(){}function p(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(c(n={},r,function(){return this}),n),v=p.prototype=s.prototype=Object.create(l);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,o,"GeneratorFunction")),e.prototype=Object.create(v),e}return f.prototype=p,c(v,"constructor",p),c(p,"constructor",f),f.displayName="GeneratorFunction",c(p,o,"GeneratorFunction"),c(v),c(v,o,"Generator"),c(v,r,function(){return this}),c(v,"toString",function(){return"[object Generator]"}),(a=function(){return{w:i,m:y}})()}function c(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}c=function(e,n,t,r){function i(n,t){c(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(i("next",0),i("throw",1),i("return",2))},c(e,n,t,r)}function s(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof n?n:n+""}var f=function(e){for(var n=new Uint8Array(e),t="",r=0;r<n.byteLength;r++)t+=String.fromCharCode(n[r]);return btoa(t)},p=function(e){for(var n=atob(e),t=new Uint8Array(n.length),r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t.buffer},l=f,v=p,y=function(e){return(new TextDecoder).decode(e)},h=function(e){return(new TextEncoder).encode(e)},d=function(e,n){for(var t=f(e),r="-----BEGIN "+n+"-----\r\n",o=0;o<t.length;)o+64<=t.length?r+=t.substring(o,o+64)+"\r\n":r+=t.substring(o)+"\r\n",o+=64;return r+="-----END "+n+"-----\r\n"},w=function(){for(var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("\n"),n="",t=0;t<e.length;t++)e[t].trim().length>0&&e[t].indexOf("-BEGIN")<0&&e[t].indexOf("-END")<0&&(n+=e[t].trim());return p(n)},b=function(e){if(e.length%2!=0)throw new Error("Invalid hexString.");for(var n=new Uint8Array(e.length/2),t=0;t<e.length;t+=2){var r=parseInt(e.substring(t,t+2),16);if(isNaN(r))throw new Error("Byte value is not a number.");n[t/2]=r}return n},g=function(e){if(!e)throw new Error("No bytes to convert to Hex");for(var n=new Uint8Array(e),t=[],r=0;r<n.length;++r){var o=n[r].toString(16);o.length<2&&(o="0".concat(o)),t.push(o)}return t.join("")},m=function(e){return btoa(e)},O=function(e){var n=(new TextEncoder).encode(e);return Array.from(n).map(function(e){return e.toString(16).padStart(2,"0")}).join("")},k=function(){return"undefined"!=typeof window&&window.crypto?window.crypto:"undefined"!=typeof global&&global.crypto?global.crypto:crypto},j=function(){var e=n(a().m(function e(n){var t,r,o,i;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t=k(),r=b(n),e.n=1,t.subtle.importKey("raw",r,"AES-GCM",!1,["encrypt","decrypt"]);case 1:return o=e.v,e.a(2,o);case 2:throw e.p=2,i=e.v,new Error("Failed to import key from hash: "+i.message);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}(),x=function(){return r(function e(){t(this,e)},[{key:"encrypt",value:(o=n(a().m(function e(n){var t,r,o,i,u,c,s;return a().w(function(e){for(;;)switch(e.n){case 0:if(t=n.plainText,r=n.passwordHex,!((o=n.nonceHex)&&o.length<24)){e.n=1;break}throw Error("Nonce "+o+"is too short");case 1:return i=k(),e.n=2,j(r);case 2:return u=e.v,c={name:"AES-GCM",iv:b(o)},e.n=3,i.subtle.encrypt(c,u,h(t));case 3:return s=e.v,e.a(2,g(s))}},e)})),function(e){return o.apply(this,arguments)})},{key:"decrypt",value:(e=n(a().m(function e(n){var t,r,o,i,u,c,s,f,p;return a().w(function(e){for(;;)switch(e.n){case 0:return t=n.cipherText,r=n.passwordHex,o=n.nonceHex,i=k(),e.n=1,j(r);case 1:return u=e.v,c=b(o),s=b(t),f={name:"AES-GCM",iv:c},e.n=2,i.subtle.decrypt(f,u,s);case 2:return p=e.v,e.a(2,y(p))}},e)})),function(n){return e.apply(this,arguments)})}]);var e,o}(),A={name:"PBKDF2"},E=function(){var e=arguments;return n(a().m(function n(){var t,r,o,i,u,c,s,f,p,l,v,y,d,w,b;return a().w(function(n){for(;;)switch(n.n){case 0:return r=(t=e.length>0&&void 0!==e[0]?e[0]:{}).plainText,o=void 0===r?"":r,i=t.salt,u=void 0===i?"":i,c=t.iterations,s=void 0===c?1e4:c,f=t.length,p=void 0===f?256:f,l=k(),n.n=1,l.subtle.importKey("raw",h(o),A,!1,["deriveKey"]);case 1:return v=n.v,y={name:A.name,salt:h(u),iterations:s,hash:"SHA-256"},d={name:"AES-GCM",length:p},n.n=2,l.subtle.deriveKey(y,v,d,!0,["encrypt","decrypt"]);case 2:return w=n.v,n.n=3,l.subtle.exportKey("raw",w);case 3:return b=n.v,n.a(2,g(b))}},n)}))()},P=function(){var e=arguments;return n(a().m(function n(){var t,r,o,i,u,c,s,f,p,l,v,y,d;return a().w(function(n){for(;;)switch(n.n){case 0:return r=(t=e.length>0&&void 0!==e[0]?e[0]:{}).plainText,o=void 0===r?"":r,i=t.salt,u=void 0===i?"":i,c=t.length,s=void 0===c?256:c,f=t.iterations,p=void 0===f?1e4:f,l=k(),n.n=1,l.subtle.importKey("raw",h(o),A,!1,["deriveBits"]);case 1:return v=n.v,y={name:A.name,salt:h(u),iterations:p,hash:"SHA-256"},n.n=2,l.subtle.deriveBits(y,v,s);case 2:return d=n.v,n.a(2,g(d))}},n)}))()},S=function(){var e=arguments;return n(a().m(function n(){var t,r,o,i,u,c,s,f,p,l,v,y,d,w,b,g;return a().w(function(n){for(;;)switch(n.n){case 0:if(r=(t=e.length>0&&void 0!==e[0]?e[0]:{}).plainText,o=void 0===r?"":r,i=t.salt,u=void 0===i?"":i,c=t.length,s=void 0===c?16:c,f=t.iterations,p=void 0===f?3:f,l=t.memory,v=void 0===l?65536:l,y=t.threads,d=void 0===y?2:y,"undefined"!=typeof window&&window.argon2){n.n=1;break}return console.warn("Argon2 not available in Node.js environment"),n.a(2,"argon2_not_available_in_nodejs");case 1:return w=window,b=w.argon2,n.n=2,b.hash({pass:o,salt:h(u),type:b.ArgonType.Argon2id,hashLen:s,time:p,mem:v,parallelism:d,version:19});case 2:return g=n.v,n.a(2,g.hashHex)}},n)}))()},K=2048,T={name:"RSA-OAEP",modulusLength:K,publicExponent:new Uint8Array([1,0,1]),extractable:!0,hash:{name:"SHA-256"}},C=function(){return r(function e(){t(this,e)},[{key:"generateKeyPair",value:(i=n(a().m(function e(){var n,t,r,o,i,c,s,f,p=arguments;return a().w(function(e){for(;;)switch(e.n){case 0:return n=p.length>0&&void 0!==p[0]?p[0]:{},t=k(),r=u(u({},T),{},{modulusLength:n.size||K}),e.n=1,t.subtle.generateKey(r,!0,["encrypt","decrypt"]);case 1:return o=e.v,e.n=2,t.subtle.exportKey("spki",o.publicKey);case 2:return i=e.v,e.n=3,t.subtle.exportKey("pkcs8",o.privateKey);case 3:return c=e.v,s=d(i,"RSA PUBLIC KEY"),f=d(c,"RSA PRIVATE KEY"),e.a(2,{publicKey:{pem:s,base64:m(s)},privateKey:{pem:f,base64:m(f)}})}},e)})),function(){return i.apply(this,arguments)})},{key:"encrypt",value:(o=n(a().m(function e(n){var t,r,o,i;return a().w(function(e){for(;;)switch(e.n){case 0:return t=k(),r=u(u({},T),{},{modulusLength:n.size||K}),e.n=1,t.subtle.importKey("spki",w(n.publicKey),r,!1,["encrypt"]);case 1:return o=e.v,e.n=2,t.subtle.encrypt(r,o,h(n.plainText));case 2:return i=e.v,e.a(2,l(i))}},e)})),function(e){return o.apply(this,arguments)})},{key:"decrypt",value:(e=n(a().m(function e(n){var t,r,o,i;return a().w(function(e){for(;;)switch(e.n){case 0:return t=k(),r=u(u({},T),{},{modulusLength:n.size||K}),e.n=1,t.subtle.importKey("pkcs8",w(n.privateKey),r,!1,["decrypt"]);case 1:return o=e.v,e.n=2,t.subtle.decrypt(r,o,v(n.cipherText));case 2:return i=e.v,e.a(2,y(i))}},e)})),function(n){return e.apply(this,arguments)})}]);var e,o,i}(),_=function(){return r(function e(){t(this,e),this.aesCipher=new x,this.rsaCipher=new C},[{key:"_getCrypto",value:function(){return k()}},{key:"generateNonce",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.length,t=void 0===n?12:n,r=e.hex,o=void 0===r||r,i=this._getCrypto().getRandomValues(new Uint8Array(t));return o?g(i):l(i)}},{key:"toHex",value:function(e){return O(e)}},{key:"encryptAes",value:(v=n(a().m(function e(n){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.aesCipher.encrypt(n);case 1:return e.a(2,e.v)}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"decryptAes",value:(p=n(a().m(function e(n){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.aesCipher.decrypt(n);case 1:return e.a(2,e.v)}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"pbkdf2",value:(f=n(a().m(function e(n){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,E(n);case 1:return e.a(2,e.v)}},e)})),function(e){return f.apply(this,arguments)})},{key:"pbkdf2HashPassword",value:(s=n(a().m(function e(n){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,P(n);case 1:return e.a(2,e.v)}},e)})),function(e){return s.apply(this,arguments)})},{key:"argon2",value:(c=n(a().m(function e(n){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,S(n);case 1:return e.a(2,e.v)}},e)})),function(e){return c.apply(this,arguments)})},{key:"generateRsaKeyPair",value:(u=n(a().m(function e(n){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.rsaCipher.generateKeyPair(n);case 1:return e.a(2,e.v)}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"encryptRsa",value:(i=n(a().m(function e(n){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.rsaCipher.encrypt(n);case 1:return e.a(2,e.v)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"decryptRsa",value:(o=n(a().m(function e(n){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.rsaCipher.decrypt(n);case 1:return e.a(2,e.v)}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"sha256",value:(e=n(a().m(function e(n){var t,r,o,i,u;return a().w(function(e){for(;;)switch(e.n){case 0:return t=this._getCrypto(),r=(new TextEncoder).encode(n),e.n=1,t.subtle.digest("SHA-256",r);case 1:return o=e.v,i=Array.from(new Uint8Array(o)),u=i.map(function(e){return("00"+e.toString(16)).slice(-2)}).join(""),e.a(2,u)}},e,this)})),function(n){return e.apply(this,arguments)})}]);var e,o,i,u,c,s,f,p,v}();return _}();
