var Cryptus=function(){"use strict";function r(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function e(r,e,n,t,o,a,u){try{var i=r[a](u),f=i.value}catch(r){return void n(r)}i.done?e(f):Promise.resolve(f).then(t,o)}function n(r){return function(){var n=this,t=arguments;return new Promise(function(o,a){var u=r.apply(n,t);function i(r){e(u,o,a,i,f,"next",r)}function f(r){e(u,o,a,i,f,"throw",r)}i(void 0)})}}function t(r,e,n){return e&&function(r,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,u(t.key),t)}}(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function o(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var r,e,n="function"==typeof Symbol?Symbol:{},t=n.iterator||"@@iterator",u=n.toStringTag||"@@toStringTag";function i(n,t,o,u){var i=t&&t.prototype instanceof c?t:c,y=Object.create(i.prototype);return a(y,"_invoke",function(n,t,o){var a,u,i,c=0,y=o||[],s=!1,p={p:0,n:0,v:r,a:l,f:l.bind(r,4),d:function(e,n){return a=e,u=0,i=r,p.n=n,f}};function l(n,t){for(u=n,i=t,e=0;!s&&c&&!o&&e<y.length;e++){var o,a=y[e],l=p.p,h=a[2];n>3?(o=h===t)&&(i=a[(u=a[4])?5:(u=3,3)],a[4]=a[5]=r):a[0]<=l&&((o=n<2&&l<a[1])?(u=0,p.v=t,p.n=a[1]):l<h&&(o=n<3||a[0]>t||t>h)&&(a[4]=n,a[5]=t,p.n=h,u=0))}if(o||n>1)return f;throw s=!0,t}return function(o,y,h){if(c>1)throw TypeError("Generator is already running");for(s&&1===y&&l(y,h),u=y,i=h;(e=u<2?r:i)||!s;){a||(u?u<3?(u>1&&(p.n=-1),l(u,i)):p.n=i:p.v=i);try{if(c=2,a){if(u||(o="next"),e=a[o]){if(!(e=e.call(a,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,u<2&&(u=0)}else 1===u&&(e=a.return)&&e.call(a),u<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),u=1);a=r}else if((e=(s=p.n<0)?i:n.call(t,p))!==f)break}catch(e){a=r,u=1,i=e}finally{c=1}}return{value:e,done:s}}}(n,o,u),!0),y}var f={};function c(){}function y(){}function s(){}e=Object.getPrototypeOf;var p=[][t]?e(e([][t]())):(a(e={},t,function(){return this}),e),l=s.prototype=c.prototype=Object.create(p);function h(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,s):(r.__proto__=s,a(r,u,"GeneratorFunction")),r.prototype=Object.create(l),r}return y.prototype=s,a(l,"constructor",s),a(s,"constructor",y),y.displayName="GeneratorFunction",a(s,u,"GeneratorFunction"),a(l),a(l,u,"Generator"),a(l,t,function(){return this}),a(l,"toString",function(){return"[object Generator]"}),(o=function(){return{w:i,m:h}})()}function a(r,e,n,t){var o=Object.defineProperty;try{o({},"",{})}catch(r){o=0}a=function(r,e,n,t){function u(e,n){a(r,e,function(r){return this._invoke(e,n,r)})}e?o?o(r,e,{value:n,enumerable:!t,configurable:!t,writable:!t}):r[e]=n:(u("next",0),u("throw",1),u("return",2))},a(r,e,n,t)}function u(r){var e=function(r,e){if("object"!=typeof r||!r)return r;var n=r[Symbol.toPrimitive];if(void 0!==n){var t=n.call(r,e);if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}(r,"string");return"symbol"==typeof e?e:e+""}var i,f,c,y,s,p,l,h,v,g,b,w,d,m;function A(){if(f)return i;function r(){if("undefined"!=typeof globalThis&&globalThis.crypto&&globalThis.crypto.subtle)return globalThis.crypto;try{var r=require("crypto").webcrypto;if(r&&r.subtle)return r}catch(r){}throw new Error("WebCrypto is not available in this environment")}function e(r){for(var e=new Uint8Array(r),n="",t=0;t<e.length;t++)n+=String.fromCharCode(e[t]);return"function"==typeof btoa?btoa(n):Buffer.from(n,"binary").toString("base64")}function n(r){for(var e="function"==typeof atob?atob(r):Buffer.from(r,"base64").toString("binary"),n=new Uint8Array(e.length),t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n.buffer}return f=1,i={getCrypto:r,arrayBufferToBase64:e,base64ToArrayBuffer:n,b64urlFromBytes:function(r){return e(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")},bytesFromB64url:function(r){var e=(r=r.replace(/-/g,"+").replace(/_/g,"/")).length%4?4-r.length%4:0;return n(r+"=".repeat(e))},arrayBufferToText:function(r){return(new TextDecoder).decode(r)},textToArrayBuffer:function(r){return(new TextEncoder).encode(r)},hexToArrayBuffer:function(r){if(!r||r.length%2!=0)throw new Error("invalid hex");for(var e=new Uint8Array(r.length/2),n=0;n<e.length;n++)e[n]=parseInt(r.slice(2*n,2*n+2),16);return e},arrayBufferToHex:function(r){for(var e=r instanceof Uint8Array?r:new Uint8Array(r),n="",t=0;t<e.length;t++)n+=e[t].toString(16).padStart(2,"0");return n},binaryToPem:function(r,n){for(var t=e(r),o="-----BEGIN "+n+"-----\n",a=0;a<t.length;a+=64)o+=t.slice(a,a+64)+"\n";return o+="-----END "+n+"-----\n"},pemToBinary:function(r){return n(r.replace(/-----[^-]+-----/g,"").replace(/\s+/g,""))},strToHex:function(r){for(var e=(new TextEncoder).encode(r),n="",t=0;t<e.length;t++)n+=e[t].toString(16).padStart(2,"0");return n},randomBytes:function(e){var n=r(),t=new Uint8Array(e);return n.getRandomValues(t),t}}}function B(){if(y)return c;y=1;var r=A();function e(r){return t.apply(this,arguments)}function t(){return(t=n(o().m(function e(n){var t,a;return o().w(function(e){for(;;)switch(e.n){case 0:if(t=r.getCrypto(),a=r.hexToArrayBuffer(n),[16,24,32].includes(a.length)){e.n=1;break}throw new Error("AES key must be 16/24/32 bytes");case 1:return e.a(2,t.subtle.importKey("raw",a,{name:"AES-GCM"},!1,["encrypt","decrypt"]))}},e)}))).apply(this,arguments)}function a(){return(a=n(o().m(function n(t,a,u){var i,f,c,y;return o().w(function(n){for(;;)switch(n.n){case 0:return i=r.getCrypto(),n.n=1,e(a);case 1:if(f=n.v,12===(c=r.hexToArrayBuffer(u)).length){n.n=2;break}throw new Error("AES-GCM nonce must be 12 bytes");case 2:return n.n=3,i.subtle.encrypt({name:"AES-GCM",iv:c},f,r.textToArrayBuffer(t));case 3:return y=n.v,n.a(2,r.arrayBufferToHex(y))}},n)}))).apply(this,arguments)}function u(){return(u=n(o().m(function n(t,a,u){var i,f,c,y,s;return o().w(function(n){for(;;)switch(n.n){case 0:return i=r.getCrypto(),n.n=1,e(a);case 1:if(f=n.v,12===(c=r.hexToArrayBuffer(u)).length){n.n=2;break}throw new Error("AES-GCM nonce must be 12 bytes");case 2:return y=r.hexToArrayBuffer(t),n.n=3,i.subtle.decrypt({name:"AES-GCM",iv:c},f,y);case 3:return s=n.v,n.a(2,r.arrayBufferToText(s))}},n)}))).apply(this,arguments)}return c={encryptAESGCMHex:function(r,e,n){return a.apply(this,arguments)},decryptAESGCMHex:function(r,e,n){return u.apply(this,arguments)}},c}function x(){if(w)return b;w=1;var r=A();function e(){return e=n(o().m(function e(){var n,t,a,u,i,f,c,y,s=arguments;return o().w(function(e){for(;;)switch(e.n){case 0:return n=s.length>0&&void 0!==s[0]?s[0]:2048,t=r.getCrypto(),a={name:"RSA-OAEP",modulusLength:n,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},e.n=1,t.subtle.generateKey(a,!0,["encrypt","decrypt"]);case 1:return u=e.v,e.n=2,t.subtle.exportKey("spki",u.publicKey);case 2:return i=e.v,e.n=3,t.subtle.exportKey("pkcs8",u.privateKey);case 3:return f=e.v,c=r.binaryToPem(i,"PUBLIC KEY"),y=r.binaryToPem(f,"PRIVATE KEY"),e.a(2,{privateKey:y,publicKey:c})}},e)})),e.apply(this,arguments)}function t(r){return a.apply(this,arguments)}function a(){return(a=n(o().m(function e(n){var t,a;return o().w(function(e){for(;;)if(0===e.n)return t=r.getCrypto(),a=r.pemToBinary(n),e.a(2,t.subtle.importKey("spki",a,{name:"RSA-OAEP",hash:"SHA-256"},!1,["encrypt"]))},e)}))).apply(this,arguments)}function u(r){return i.apply(this,arguments)}function i(){return(i=n(o().m(function e(n){var t,a;return o().w(function(e){for(;;)if(0===e.n)return t=r.getCrypto(),a=r.pemToBinary(n),e.a(2,t.subtle.importKey("pkcs8",a,{name:"RSA-OAEP",hash:"SHA-256"},!1,["decrypt"]))},e)}))).apply(this,arguments)}function f(){return(f=n(o().m(function e(n,a){var u,i,f;return o().w(function(e){for(;;)switch(e.n){case 0:return u=r.getCrypto(),e.n=1,t(a);case 1:return i=e.v,e.n=2,u.subtle.encrypt({name:"RSA-OAEP"},i,r.textToArrayBuffer(n));case 2:return f=e.v,e.a(2,r.b64urlFromBytes(new Uint8Array(f)))}},e)}))).apply(this,arguments)}function c(){return(c=n(o().m(function e(n,t){var a,i,f,c;return o().w(function(e){for(;;)switch(e.n){case 0:return a=r.getCrypto(),e.n=1,u(t);case 1:return i=e.v,f=r.bytesFromB64url(n),e.n=2,a.subtle.decrypt({name:"RSA-OAEP"},i,f);case 2:return c=e.v,e.a(2,r.arrayBufferToText(c))}},e)}))).apply(this,arguments)}return b={generateRsaKeyPair:function(){return e.apply(this,arguments)},encryptRsaOAEPB64:function(r,e){return f.apply(this,arguments)},decryptRsaOAEPB64:function(r,e){return c.apply(this,arguments)}},b}var T=function(){if(m)return d;m=1;var r=A(),e=B(),a=function(){if(p)return s;p=1;var r=A();function e(){if("undefined"!=typeof window&&window.sodium&&window.sodium.ready)return window.sodium;throw new Error("ChaCha20-Poly1305 not available (libsodium not found)")}function t(){return(t=n(o().m(function n(t,a,u){var i,f,c,y,s,p;return o().w(function(n){for(;;)switch(n.n){case 0:return i=e(),n.n=1,i.ready;case 1:if(f=r.hexToArrayBuffer(a),c=r.hexToArrayBuffer(u),f.length===i.crypto_aead_chacha20poly1305_ietf_KEYBYTES){n.n=2;break}throw new Error("ChaCha20 key must be 32 bytes");case 2:if(c.length===i.crypto_aead_chacha20poly1305_ietf_NPUBBYTES){n.n=3;break}throw new Error("ChaCha20 nonce must be 12 bytes");case 3:return y=r.textToArrayBuffer(t),s=new Uint8Array(0),p=i.crypto_aead_chacha20poly1305_ietf_encrypt(y,s,null,c,f),n.a(2,r.arrayBufferToHex(p))}},n)}))).apply(this,arguments)}function a(){return(a=n(o().m(function n(t,a,u){var i,f,c,y,s,p;return o().w(function(n){for(;;)switch(n.n){case 0:return i=e(),n.n=1,i.ready;case 1:return f=r.hexToArrayBuffer(a),c=r.hexToArrayBuffer(u),y=r.hexToArrayBuffer(t),s=new Uint8Array(0),p=i.crypto_aead_chacha20poly1305_ietf_decrypt(null,y,s,c,f),n.a(2,r.arrayBufferToText(p))}},n)}))).apply(this,arguments)}return s={encryptChaCha20Hex:function(r,e,n){return t.apply(this,arguments)},decryptChaCha20Hex:function(r,e,n){return a.apply(this,arguments)}},s}(),u=function(){if(h)return l;h=1;var r=A();function e(){return e=n(o().m(function e(n,t){var a,u,i,f,c,y=arguments;return o().w(function(e){for(;;)switch(e.n){case 0:return a=y.length>2&&void 0!==y[2]?y[2]:1e4,u=y.length>3&&void 0!==y[3]?y[3]:16,i=r.getCrypto(),e.n=1,i.subtle.importKey("raw",r.textToArrayBuffer(n),{name:"PBKDF2"},!1,["deriveBits"]);case 1:return f=e.v,e.n=2,i.subtle.deriveBits({name:"PBKDF2",salt:r.textToArrayBuffer(t),iterations:a,hash:"SHA-256"},f,8*u);case 2:return c=e.v,e.a(2,r.arrayBufferToHex(c))}},e)})),e.apply(this,arguments)}return l={pbkdf2Hex:function(r,n){return e.apply(this,arguments)}},l}(),i=u.pbkdf2Hex,f=function(){if(g)return v;g=1;var r=A();function e(){return e=n(o().m(function e(n,t){var a,u,i,f,c,y,s=arguments;return o().w(function(e){for(;;)switch(e.n){case 0:if(a=s.length>2&&void 0!==s[2]?s[2]:32,u=s.length>3&&void 0!==s[3]?s[3]:3,i=s.length>4&&void 0!==s[4]?s[4]:65536,f=s.length>5&&void 0!==s[5]?s[5]:1,"undefined"!=typeof window&&window.argon2&&window.argon2.hash){e.n=1;break}throw new Error("Argon2 is not available in this environment (expecting argon2-browser)");case 1:return c=window.argon2,e.n=2,c.hash({pass:n instanceof Uint8Array?n:r.textToArrayBuffer(n),salt:t instanceof Uint8Array?t:r.textToArrayBuffer(t),type:c.ArgonType.Argon2id,hashLen:a,time:u,mem:i,parallelism:f,version:19});case 2:return y=e.v,e.a(2,y.hashHex)}},e)})),e.apply(this,arguments)}return v={argon2Hex:function(r,n){return e.apply(this,arguments)}},v}(),c=f.argon2Hex,y=x(),b=function(){return t(function r(){!function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r)},[{key:"generateNonceBytes",value:(A=n(o().m(function e(n){return o().w(function(e){for(;;)if(0===e.n)return e.a(2,r.randomBytes(n))},e)})),function(r){return A.apply(this,arguments)})},{key:"generateNonceHex",value:(m=n(o().m(function e(n){return o().w(function(e){for(;;)if(0===e.n)return e.a(2,r.arrayBufferToHex(r.randomBytes(n)))},e)})),function(r){return m.apply(this,arguments)})},{key:"generateNonceB64URL",value:(d=n(o().m(function e(n){return o().w(function(e){for(;;)if(0===e.n)return e.a(2,r.b64urlFromBytes(r.randomBytes(n)))},e)})),function(r){return d.apply(this,arguments)})},{key:"sha256Hex",value:(w=n(o().m(function e(n){var t,a;return o().w(function(e){for(;;)switch(e.n){case 0:return t=r.getCrypto(),e.n=1,t.subtle.digest("SHA-256",r.textToArrayBuffer(n));case 1:return a=e.v,e.a(2,r.arrayBufferToHex(a))}},e)})),function(r){return w.apply(this,arguments)})},{key:"compareHashHex",value:function(r,e){if("string"!=typeof r||"string"!=typeof e)return!1;if(r.length!==e.length){for(var n=0;n<r.length;n++)0^r.charCodeAt(n);return!1}for(var t=0,o=0;o<r.length;o++)t|=r.charCodeAt(o)^e.charCodeAt(o);return 0===t}},{key:"pbkdf2",value:(b=n(o().m(function r(e,n){var t,a,u,f=arguments;return o().w(function(r){for(;;)if(0===r.n)return t=f.length>2&&void 0!==f[2]?f[2]:{},a=Number.isInteger(t.iterations)?t.iterations:1e4,u=Number.isInteger(t.length)?t.length:16,r.a(2,i(e,n,a,u))},r)})),function(r,e){return b.apply(this,arguments)})},{key:"argon2Hex",value:(g=n(o().m(function r(e,n){var t,a,u,i,f,y=arguments;return o().w(function(r){for(;;)if(0===r.n)return t=y.length>2&&void 0!==y[2]?y[2]:{},a=Number.isInteger(t.length)?t.length:32,u=Number.isInteger(t.iterations)?t.iterations:3,i=Number.isInteger(t.memory)?t.memory:65536,f=Number.isInteger(t.threads)?t.threads:1,r.a(2,c(e,n,a,u,i,f))},r)})),function(r,e){return g.apply(this,arguments)})},{key:"encryptAESGCMHex",value:(v=n(o().m(function r(n,t,a){return o().w(function(r){for(;;)if(0===r.n)return r.a(2,e.encryptAESGCMHex(n,t,a))},r)})),function(r,e,n){return v.apply(this,arguments)})},{key:"decryptAESGCMHex",value:(h=n(o().m(function r(n,t,a){return o().w(function(r){for(;;)if(0===r.n)return r.a(2,e.decryptAESGCMHex(n,t,a))},r)})),function(r,e,n){return h.apply(this,arguments)})},{key:"encryptChaCha20Hex",value:(l=n(o().m(function r(e,n,t){return o().w(function(r){for(;;)if(0===r.n)return r.a(2,a.encryptChaCha20Hex(e,n,t))},r)})),function(r,e,n){return l.apply(this,arguments)})},{key:"decryptChaCha20Hex",value:(p=n(o().m(function r(e,n,t){return o().w(function(r){for(;;)if(0===r.n)return r.a(2,a.decryptChaCha20Hex(e,n,t))},r)})),function(r,e,n){return p.apply(this,arguments)})},{key:"generateRsaKeyPair",value:(s=n(o().m(function r(){var e,n,t,a,u=arguments;return o().w(function(r){for(;;)switch(r.n){case 0:return e=u.length>0&&void 0!==u[0]?u[0]:2048,r.n=1,y.generateRsaKeyPair(e);case 1:return n=r.v,t=n.privateKey,a=n.publicKey,r.a(2,{privateKey:t,publicKey:a})}},r)})),function(){return s.apply(this,arguments)})},{key:"encryptRsaOAEPB64",value:(f=n(o().m(function r(e,n){return o().w(function(r){for(;;)if(0===r.n)return r.a(2,y.encryptRsaOAEPB64(e,n))},r)})),function(r,e){return f.apply(this,arguments)})},{key:"decryptRsaOAEPB64",value:(u=n(o().m(function r(e,n){return o().w(function(r){for(;;)if(0===r.n)return r.a(2,y.decryptRsaOAEPB64(e,n))},r)})),function(r,e){return u.apply(this,arguments)})}]);var u,f,s,p,l,h,v,g,b,w,d,m,A}();return d=b}();return r(T)}();
